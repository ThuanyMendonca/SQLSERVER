class Program
{
    static void Main(string[] args)
    {
        SqlConnection con = new SqlConnection("String de Conexão com o DBTeste");

        SqlCommand cmd1 = con.CreateCommand();        
        SqlCommand cmd2 = con.CreateCommand();

        cmd1.CommandText = "insert into Tabela1 (CampoTexto) values ('UM')";
        cmd2.CommandText = "insert into Tabela2 (CampoNumerico) values ('DOIS')";

        con.Open();

        SqlTransaction tran = con.BeginTransaction();       

        try
        {
            cmd1.Transaction = tran;
            cmd1.ExecuteNonQuery();
            Console.WriteLine("Comando 1 executado com sucesso!");

            cmd2.Transaction = tran;
            cmd2.ExecuteNonQuery();
            Console.WriteLine("Comando 2 executado com sucesso!");

            tran.Commit();
        }
        catch (SqlException ex)
        {
            tran.Rollback();
            Console.WriteLine(ex.Message);
        }
        finally
        {
            con.Close();
        }

        Console.ReadLine();
    }
}